;/*FB_PKG_DELIM*/

__d("XFeedSubFollowController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/feed/profile/sub_follow/",{__asyncDialog:{type:"Int"},id:{type:"Int"},action:{type:"Enum",enumType:1},location:{type:"Int"}})}),null);
__d("MProfileSeeFirst",["$","Bootloader","CSS","DOM","FollowStrings","MRequest","MURI","Stratcom","SubscriptionsHandler","XFeedSubFollowController","destroyOnUnload"],(function(a,b,c,d,e,f,g){var h,i,j,k="unfollow",l="follow",m="see_first",n="/a/subscriptions/remove",o="/a/subscriptions/add",p=151,q=function(){function a(a,b,e,g,q,r,s,t,u,v,w,x,y){var z=this;this.changeFollowState=function(a){if(a===z.$6)return;a===k&&z.$1.removeAttribute("data-sigil");z.changeFollowStateUI(a);if(z.$6===k){var b=z.$13===p&&z.$16!==null&&z.$16!==void 0?new(c("MRequest"))(z.$16):new(c("MRequest"))(new(c("MURI"))(o));b.setData({subject_id:z.$7,forceredirect:!1,location:z.$13});b.listen("done",function(){a===m?z.changeSubFollowState(a):z.$6=a});b.listen("error",z.changeFollowStateUI.bind(z,z.$6));b.send()}else if(a===k){b=new(c("MRequest"))(new(c("MURI"))(n)).setData({subject_id:z.$7,forceredirect:!1,location:z.$13});b.listen("error",z.changeFollowStateUI.bind(z,z.$6));b.listen("done",function(){z.$6=a});b.send()}else z.changeSubFollowState(a);z.$10&&(a===k||a===m?z.renderAwesomizerUpsell(a,z.$12):a===l&&(i&&i.hideAwesomizerUpsell()))};this.changeFollowStateUI=function(a){var b=z.getActiveFollowButton(a);c("CSS").removeClass(z.$2,"selectedOption");c("CSS").removeClass(z.$3,"selectedOption");z.$4&&c("CSS").removeClass(z.$4,"selectedOption");b&&c("CSS").addClass(b,"selectedOption");z.setActionBarFollowButton(a);d("DOM").setContent(z.$5,z.getFollowString(a))};this.destroy=function(){j&&(h.unmountComponentAtNode(j,f.id),d("DOM").remove(j),j=null,i=null),z.$14&&z.$14.release(),z.$14=null,z.$15&&z.$15.remove()};this.$1=a;this.$2=b;this.$3=e;this.$4=g;this.$5=q.children[0];this.$6=r;this.$7=s;this.$8=t;this.$9=u;this.$10=v;this.$11=!1;this.$12=w;this.$13=x;this.$16=y;q=this.getActiveFollowButton(this.$6);q&&c("CSS").addClass(q,"selectedOption");d("DOM").setContent(this.$5,this.getFollowString(this.$6));this.$14=new(c("SubscriptionsHandler"))();this.$14.addSubscriptions(d("DOM").listen(a,"click",null,function(){z.$6===k&&!z.$11&&(z.$1.setAttribute("data-sigil","follow-flyout"),z.changeFollowState(l)),z.$11=!z.$11,z.$11||i&&i.hideAwesomizerUpsell()}),d("DOM").listen(b,"click",null,this.changeFollowState.bind(this,k)),d("DOM").listen(e,"click",null,this.changeFollowState.bind(this,l)));this.$14&&g&&this.$14.addSubscriptions(d("DOM").listen(g,"click",null,this.changeFollowState.bind(this,m)));c("destroyOnUnload")(this.destroy.bind(this))}var e=a.prototype;e.setActionBarFollowButton=function(a){if(a===this.$6)return;c("CSS").removeClass(this.$1,"following");c("CSS").removeClass(this.$1,"seefirst");c("CSS").removeClass(this.$1,"follow");a===k?c("CSS").addClass(this.$1,"follow"):a===l?c("CSS").addClass(this.$1,"following"):c("CSS").addClass(this.$1,"seefirst");if(this.$13!==364&&this.$13!==365){var b=d("DOM").find(this.$1,"*","m-profile-action-button-label");d("DOM").setContent(b,this.getActionBarButtonText(a))}else if(this.$13==364){b=d("DOM").find(this.$1,"*","m-profile-action-rectangular-button-label");d("DOM").setContent(b,this.getActionBarButtonText(a))}};e.renderAwesomizerUpsell=function(a,e){c("Bootloader").loadModules(["React","ReactDOM","MAwesomizerUpsell.react"],function(f,g,k){b=f;h=g;j||(j=d("DOM").create("div"),c("$")("page").appendChild(j));f={followState:a,isWorkUser:e};i=h.render(b.jsx(k,babelHelpers["extends"]({},f)),j,"MProfileSeeFirst.js")},"MProfileSeeFirst")};e.changeSubFollowState=function(a){var b=this;a===m&&(this.$15=c("Stratcom").listen("revert",null,function(){c("Stratcom").removeCurrentListener(),alert(b.$9),b.changeFollowStateUI(l),b.$6=l}));var d=c("XFeedSubFollowController").getURIBuilder().setInt("id",this.$7).setEnum("action",a).setInt("location",this.$13).getURI();d=new(c("MRequest"))(d);d.listen("done",function(){b.$6=a});d.listen("error",this.changeFollowStateUI.bind(this,this.$6));d.send()};e.getActionBarButtonText=function(a){if(a===k)return c("FollowStrings").follow;else if(a===l)return c("FollowStrings").followed;else return c("FollowStrings").seeFirst};e.getFollowString=function(a){if(a===k)if(this.$8)return c("FollowStrings").unfollowFriendSubtextMobile;else return c("FollowStrings").unfollowNonFriendSubtextMobile;else if(a===l)return c("FollowStrings").regularFollowSubtextMobile;else return c("FollowStrings").seeFirstSubtextMobile};e.getActiveFollowButton=function(a){if(a===k)return this.$2;else if(a===l)return this.$3;else return this.$4};return a}(),r=null;function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n){r&&r.destroy(),r=new q(a,b,c,d,e,f,g,h,i,j,k,l,m)}g.init=a}),98);